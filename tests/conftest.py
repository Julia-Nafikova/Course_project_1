import pytest


@pytest.fixture
def top_transactions():
    """from 04.11.2021 23:50:17"""
    return [{'date': '01.11.2021', 'amount': 525.0, 'category': 'Одежда и обувь', 'description': 'WILDBERRIES'}, {'date': '01.11.2021', 'amount': 228.0, 'category': 'Супермаркеты', 'description': 'Колхоз'}, {'date': '01.11.2021', 'amount': 110.0, 'category': 'Фастфуд', 'description': 'Mouse Tail'}]


@pytest.fixture
def generate_all_transactions():
    """from 01.11.2021 23:50:17"""
    return [{'Дата операции': '01.11.2021 15:32:24', 'Дата платежа': '01.11.2021', 'Номер карты': '*4556', 'Статус': 'OK', 'Сумма операции': -228.0, 'Валюта операции': 'RUB', 'Сумма платежа': -228.0, 'Валюта платежа': 'RUB', 'Кэшбэк': 11.0, 'Категория': 'Супермаркеты', 'MCC': 5411.0, 'Описание': 'Колхоз', 'Бонусы (включая кэшбэк)': 11, 'Округление на инвесткопилку': 0, 'Сумма операции с округлением': 228.0}, {'Дата операции': '01.11.2021 11:01:19', 'Дата платежа': '01.11.2021', 'Номер карты': '*4556', 'Статус': 'OK', 'Сумма операции': -110.0, 'Валюта операции': 'RUB', 'Сумма платежа': -110.0, 'Валюта платежа': 'RUB', 'Кэшбэк': 1.0, 'Категория': 'Фастфуд', 'MCC': 5814.0, 'Описание': 'Mouse Tail', 'Бонусы (включая кэшбэк)': 1, 'Округление на инвесткопилку': 0, 'Сумма операции с округлением': 110.0}, {'Дата операции': '31.10.2021 19:06:21', 'Дата платежа': '01.11.2021', 'Номер карты': '*4556', 'Статус': 'OK', 'Сумма операции': -525.0, 'Валюта операции': 'RUB', 'Сумма платежа': -525.0, 'Валюта платежа': 'RUB', 'Кэшбэк': 26.0, 'Категория': 'Одежда и обувь', 'MCC': 5651.0, 'Описание': 'WILDBERRIES', 'Бонусы (включая кэшбэк)': 26, 'Округление на инвесткопилку': 0, 'Сумма операции с округлением': 525.0}]


@pytest.fixture
def filtered_cards():
    return [{'last_digit': '*4556', 'total_spent': -228.0, 'cashback': -2.28}, {'last_digit': '*4556', 'total_spent': -110.0, 'cashback': -1.1}, {'last_digit': '*4556', 'total_spent': -525.0, 'cashback': -5.25}]


@pytest.fixture
def get_excel_0():
    return {'Дата операции': '02.11.2021 10:05:06', 'Дата платежа': '02.11.2021', 'Номер карты': '*4556', 'Статус': 'OK', 'Сумма операции': -69.99, 'Валюта операции': 'RUB', 'Сумма платежа': -69.99, 'Валюта платежа': 'RUB', 'Кэшбэк': 3.0, 'Категория': 'Супермаркеты', 'MCC': 5411.0, 'Описание': 'Магнит', 'Бонусы (включая кэшбэк)': 3, 'Округление на инвесткопилку': 0, 'Сумма операции с округлением': 69.99}


@pytest.fixture
def number():
    return [
    {
        "Дата операции": "18.11.2021 21:15:27",
        "Дата платежа": "19.11.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -200.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -200.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Тинькофф Мобайл +7 995 555-55-55",
        "Бонусы (включая кэшбэк)": 2,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 200.0
    },
    {
        "Дата операции": "18.11.2021 21:15:27",
        "Дата платежа": "19.11.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": 200.0,
        "Валюта операции": "RUB",
        "Сумма платежа": 200.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Пополнения",
        "MCC": NaN,
        "Описание": "Тинькофф Мобайл +7 995 555-55-55",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 200.0
    },
    {
        "Дата операции": "29.09.2021 18:48:24",
        "Дата платежа": "29.09.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 1,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    },
    {
        "Дата операции": "29.09.2021 09:22:42",
        "Дата платежа": "29.09.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -400.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -400.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 4,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 400.0
    },
    {
        "Дата операции": "29.08.2021 10:59:03",
        "Дата платежа": "29.08.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -240.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -240.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 2,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 240.0
    },
    {
        "Дата операции": "14.03.2021 09:49:03",
        "Дата платежа": "14.03.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -150.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -150.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 981 333-44-55",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 150.0
    },
    {
        "Дата операции": "07.03.2021 12:00:06",
        "Дата платежа": "07.03.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -50.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -50.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 981 333-33-33",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 50.0
    },
    {
        "Дата операции": "19.02.2021 19:37:03",
        "Дата платежа": "19.02.2021",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -20.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -20.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МегаФон +7 921 333-33-33",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 20.0
    },
    {
        "Дата операции": "28.12.2020 10:01:58",
        "Дата платежа": "28.12.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 921 111-22-33",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    },
    {
        "Дата операции": "23.12.2020 13:19:27",
        "Дата платежа": "23.12.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -10.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -10.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 10.0
    },
    {
        "Дата операции": "03.12.2020 23:32:21",
        "Дата платежа": "04.12.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -10.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -10.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 666-66-66",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 10.0
    },
    {
        "Дата операции": "29.11.2020 09:29:33",
        "Дата платежа": "29.11.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -300.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -300.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 921 111-22-33",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 300.0
    },
    {
        "Дата операции": "25.11.2020 18:11:15",
        "Дата платежа": "25.11.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -200.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -200.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 981 888-88-88",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 200.0
    },
    {
        "Дата операции": "10.11.2020 23:31:41",
        "Дата платежа": "11.11.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 976-14-20",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    },
    {
        "Дата операции": "05.11.2020 19:19:14",
        "Дата платежа": "05.11.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -10.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -10.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 976-14-20",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 10.0
    },
    {
        "Дата операции": "04.11.2020 23:05:37",
        "Дата платежа": "05.11.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -50.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -50.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 976-14-20",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 50.0
    },
    {
        "Дата операции": "28.10.2020 12:35:11",
        "Дата платежа": "28.10.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 111-22-33",
        "Бонусы (включая кэшбэк)": 1,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    },
    {
        "Дата операции": "22.07.2020 10:19:29",
        "Дата платежа": "22.07.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 985 111-11-11",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    },
    {
        "Дата операции": "18.07.2020 21:05:23",
        "Дата платежа": "19.07.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -50.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -50.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС Mobile +7 921 999-99-99",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 50.0
    },
    {
        "Дата операции": "28.05.2020 09:36:48",
        "Дата платежа": "28.05.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -315.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -315.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 3,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 315.0
    },
    {
        "Дата операции": "18.03.2020 17:28:04",
        "Дата платежа": "18.03.2020",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -400.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -400.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 911 198-78-58",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 400.0
    },
    {
        "Дата операции": "05.11.2019 09:40:44",
        "Дата платежа": "05.11.2019",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -50.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -50.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 555-55-55",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 50.0
    },
    {
        "Дата операции": "05.11.2019 09:38:52",
        "Дата платежа": "05.11.2019",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -500.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -500.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 976-14-20",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 500.0
    },
    {
        "Дата операции": "31.01.2019 13:34:15",
        "Дата платежа": "31.01.2019",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -35.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -35.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Teletie Бизнес +7 966 000-00-00",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 35.0
    },
    {
        "Дата операции": "18.11.2018 14:46:44",
        "Дата платежа": "18.11.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -200.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -200.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 911 000-09-09",
        "Бонусы (включая кэшбэк)": 2,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 200.0
    },
    {
        "Дата операции": "14.11.2018 20:43:00",
        "Дата платежа": "14.11.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -150.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -150.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 911 882-65-08",
        "Бонусы (включая кэшбэк)": 1,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 150.0
    },
    {
        "Дата операции": "18.10.2018 17:01:08",
        "Дата платежа": "18.10.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -40.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -40.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Билайн +7 962 717-08-52",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 40.0
    },
    {
        "Дата операции": "18.10.2018 17:00:25",
        "Дата платежа": "18.10.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -40.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -40.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Билайн +7 962 717-08-52",
        "Бонусы (включая кэшбэк)": 0,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 40.0
    },
    {
        "Дата операции": "03.07.2018 21:30:39",
        "Дата платежа": "03.07.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -150.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -150.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 981 127-94-00",
        "Бонусы (включая кэшбэк)": 1,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 150.0
    },
    {
        "Дата операции": "12.04.2018 11:03:57",
        "Дата платежа": "12.04.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -300.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -300.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "МТС +7 911 695-42-03",
        "Бонусы (включая кэшбэк)": 3,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 300.0
    },
    {
        "Дата операции": "27.02.2018 23:17:40",
        "Дата платежа": "28.02.2018",
        "Номер карты": NaN,
        "Статус": "OK",
        "Сумма операции": -100.0,
        "Валюта операции": "RUB",
        "Сумма платежа": -100.0,
        "Валюта платежа": "RUB",
        "Кэшбэк": NaN,
        "Категория": "Мобильная связь",
        "MCC": NaN,
        "Описание": "Я МТС +7 921 11-22-33",
        "Бонусы (включая кэшбэк)": 1,
        "Округление на инвесткопилку": 0,
        "Сумма операции с округлением": 100.0
    }
]